doctype html
html
  head
    meta(charset="utf-8")
    meta(http-equiv="X-UA-Compatible", content="IE=edge")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    title Trip Track
    style !{bootstrap}
    script !{chartJs}
    script !{momentJs}
    script.
      function secondsToString(v) {
        var m = moment.duration(v, 'seconds');
        var s = '';
        if (m.hours() > 0) {
          s += m.hours() + 'h ';
        }
        s += m.minutes() + 'm';
        return s;
      }
  body
    mixin routeName(r)
      code= r.start
      span
        |
        | to
        |
      code= r.end

    #main.container-fluid
      .row
        ul
          each r in routes
            li
              a(href='#'+r.id)
                +routeName(r)
      .row
        each r in routes
          .route.col-lg-3.col-sm-6
            h3
              +routeName(r)
            .graph
              canvas(id=r.id)
              script.
                var ctx = document.getElementById("#{r.id}").getContext('2d');
                var r = !{JSON.stringify(r, null, '  ')};
                var myChart = new Chart(ctx, {
                  type: 'line',
                  data: {
                    labels: r.labels,
                    datasets: [{
                      data: r.data
                    }],
                  },
                  options: {
                    responsive: true,
                    legend: false,
                    tooltips: {
                      callbacks: {
                        label: function(tip) {
                          return secondsToString(tip.yLabel);
                        }
                      }
                    },
                    scales: {
                      yAxes: [{
                        ticks: {
                          callback: function(v) {
                            return secondsToString(v);
                          }
                        }
                      }],
                      xAxes: [{
                        gridLines: {
                          offsetGridLines: false
                        },
                        offset: true,
                        type: 'time',
                        time: {
                          parser: "x",
                          tooltipFormat: "ddd h:mma"
                        }
                      }]
                    }
                  }
                });
            table.table.table-striped.table-condensed
              thead
                tr
                  th Time of day
                  th Duration
              tbody
                each t in r.times
                  tr
                    td #{t.time}
                    td #{t.duration}
